from pypdf import PdfWriter
from pypdf.generic import (
    DictionaryObject,
    NameObject,
    RectangleObject,
    TextStringObject,
    FloatObject,
    ArrayObject,
)

writer = PdfWriter(clone_from="basic.pdf")


# Example: Create a text annotation
text_annotation = DictionaryObject(
    {
        NameObject("/Type"): NameObject("/Annot"),
        NameObject("/Subtype"): NameObject("/Text"),
        NameObject("/Rect"): RectangleObject(
            [
                FloatObject(100.0),
                FloatObject(100.0),
                FloatObject(200.0),
                FloatObject(150.0),
            ]
        ),
        NameObject("/Contents"): TextStringObject("Click me!"),
        NameObject("/C"): ArrayObject(
            [FloatObject(1.0), FloatObject(0.0), FloatObject(0.0)]
        ),  # Red color
    }
)

# Assuming you have a page in your writer
writer.add_page(writer.add_blank_page(width=600, height=800))
added_annot = writer.add_annotation(page_number=0, annotation=text_annotation)

javascript_action = DictionaryObject(
    {
        NameObject("/S"): NameObject("/JavaScript"),
        NameObject("/JS"): TextStringObject("app.alert('Hello from JavaScript!');"),
    }
)

added_annot[NameObject("/A")] = javascript_action

# Write to pypdf-output.pdf.
with open("basic-output.pdf", "wb") as fp:
    writer.write(fp)
